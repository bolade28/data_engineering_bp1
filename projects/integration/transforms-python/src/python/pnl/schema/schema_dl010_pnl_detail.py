from pyspark.sql.types import StructField, StructType, StringType, DoubleType, IntegerType, DateType, TimestampType

typed_output_schema = StructType([
  StructField('Run_Datetime', TimestampType(), True),
  StructField('deal_num', IntegerType(), True),
  StructField('internal_portfolio', IntegerType(), True),
  StructField('param_seq_num', IntegerType(), True),
  StructField('param_seq_num_1', IntegerType(), True),
  StructField('Base_Currency', StringType(), True),
  StructField('Disc_Index', IntegerType(), True),
  StructField('Instrument_Type', StringType(), True),
  StructField('Portfolio', StringType(), True),
  StructField('Proj_Index', IntegerType(), True),
  StructField('Reval_Date', DateType(), True),
  StructField('Reval_Type', StringType(), True),
  StructField('Scenario_ID', IntegerType(), True),
  StructField('base_realized_value', DoubleType(), True),
  StructField('base_total_value', DoubleType(), True),
  StructField('base_unrealized_value', DoubleType(), True),
  StructField('broker_fee_type', IntegerType(), True),
  StructField('cflow_type', StringType(), True),
  StructField('change_in_tot_pnl', DoubleType(), True),
  StructField('comm_opt_exercised_flag', IntegerType(), True),
  StructField('currency_id', StringType(), True),
  StructField('df', DoubleType(), True),
  StructField('end_date', DateType(), True),
  StructField('event_source_id', StringType(), True),
  StructField('ins_num', IntegerType(), True),
  StructField('ins_seq_num', IntegerType(), True),
  StructField('ins_source_id', IntegerType(), True),
  StructField('new_deal', IntegerType(), True),
  StructField('price', DoubleType(), True),
  StructField('price_band', IntegerType(), True),
  StructField('price_band_seq_num', IntegerType(), True),
  StructField('profile_seq_num', IntegerType(), True),
  StructField('pymt', DoubleType(), True),
  StructField('pymt_date', DateType(), True),
  StructField('rate_dtmn_date', DateType(), True),
  StructField('rate_status', IntegerType(), True),
  StructField('realized_value', DoubleType(), True),
  StructField('settlement_type', StringType(), True),
  StructField('start_date', DateType(), True),
  StructField('strike', DoubleType(), True),
  StructField('total_value', DoubleType(), True),
  StructField('tran_num', IntegerType(), True),
  StructField('tran_status', StringType(), True),
  StructField('unrealized_value', DoubleType(), True),
  StructField('volume', DoubleType(), True),
  StructField('yest_base_realized_value', DoubleType(), True),
  StructField('yest_base_total_value', DoubleType(), True),
  StructField('yest_base_unrealized_value', DoubleType(), True),
  StructField('yest_pymt', DoubleType(), True),
  StructField('yest_realized_value', DoubleType(), True),
  StructField('yest_total_value', DoubleType(), True),
  StructField('yest_tran_status', IntegerType(), True),
  StructField('yest_unrealized_value', DoubleType(), True),
  StructField('Toolset', StringType(), True),
  StructField('DTD_Total_PnL_Disc_Deal', DoubleType(), True),
  StructField('DTD_Real_Disc_Deal', DoubleType(), True),
  StructField('DTD_Unreal_Disc_Deal', DoubleType(), True),
  StructField('DTD_Total_PnL_Disc_Pf', DoubleType(), True),
  StructField('DTD_Unreal_Disc_Pf', DoubleType(), True),
  StructField('DTD_Real_Disc_Pf', DoubleType(), True),
  StructField('Internal_Business_Unit', StringType(), True),
  StructField('Internal_Legal_Entity', StringType(), True),
  StructField('External_Business_Unit', StringType(), True),
  StructField('External_Legal_Entity', StringType(), True),
  StructField('External_Portfolio', StringType(), True),
  StructField('Reference', StringType(), True)
])

transformed_output_schema = StructType([
  StructField('Valuation_Date', DateType(), True),
  StructField('Deal_Number', IntegerType(), True),
  StructField('Tran_Status', StringType(), True),
  StructField('Portfolio', StringType(), True),
  StructField('Instrument_Type', StringType(), True),
  StructField('Start_Date', DateType(), True),
  StructField('End_Date', DateType(), True),
  StructField('LTD_Real_Disc_Pf', DoubleType(), True),
  StructField('LTD_Unreal_Disc_Pf', DoubleType(), True),
  StructField('LTD_Total_PnL_Disc_Pf', DoubleType(), True),
  StructField('LTD_Real_Disc_Deal', DoubleType(), True),
  StructField('LTD_Unreal_Disc_Deal', DoubleType(), True),
  StructField('LTD_Total_PnL_Disc_Deal', DoubleType(), True),
  StructField('Yest_LTD_Real_Disc_Pf', DoubleType(), True),
  StructField('Yest_LTD_Unreal_Disc_Pf', DoubleType(), True),
  StructField('Yest_LTD_Total_PnL_Disc_Pf', DoubleType(), True),
  StructField('Yest_LTD_Real_Disc_Deal', DoubleType(), True),
  StructField('Yest_LTD_Unreal_Disc_Deal', DoubleType(), True),
  StructField('Yest_LTD_Total_PnL_Disc_Deal', DoubleType(), True),
  StructField('DTD_Real_Disc_Pf', DoubleType(), True),
  StructField('DTD_Unreal_Disc_Pf', DoubleType(), True),
  StructField('DTD_Total_PnL_Disc_Pf', DoubleType(), True),
  StructField('DTD_Real_Disc_Deal', DoubleType(), True),
  StructField('DTD_Unreal_Disc_Deal', DoubleType(), True),
  StructField('DTD_Total_PnL_Disc_Deal', DoubleType(), True),
  StructField('Pymt', DoubleType(), True),
  StructField('Yest_Pymt', DoubleType(), True),
  StructField('Yest_Tran_Status', IntegerType(), True),
  StructField('Run_Datetime', TimestampType(), True),
  StructField('Internal_Portfolio', IntegerType(), True),
  StructField('Param_Seq_Num', IntegerType(), True),
  StructField('Param_Seq_Num_1', IntegerType(), True),
  StructField('Base_Currency', StringType(), True),
  StructField('Disc_Index', IntegerType(), True),
  StructField('Proj_Index', IntegerType(), True),
  StructField('Reval_Type', StringType(), True),
  StructField('Scenario_Id', IntegerType(), True),
  StructField('Broker_Fee_Type', IntegerType(), True),
  StructField('Cflow_Type', StringType(), True),
  StructField('Comm_Opt_Exerc_Flag', IntegerType(), True),
  StructField('Currency_Id', StringType(), True),
  StructField('Df', DoubleType(), True),
  StructField('Event_Source_Id', StringType(), True),
  StructField('Ins_Num', IntegerType(), True),
  StructField('Ins_Seq_Num', IntegerType(), True),
  StructField('Ins_Source_Id', IntegerType(), True),
  StructField('New_Deal', IntegerType(), True),
  StructField('Price', DoubleType(), True),
  StructField('Price_Band', IntegerType(), True),
  StructField('Price_Band_Seq_Num', IntegerType(), True),
  StructField('Profile_Seq_Num', IntegerType(), True),
  StructField('Pymt_Date', DateType(), True),
  StructField('Rate_Dtmn_Date', DateType(), True),
  StructField('Rate_Status', IntegerType(), True),
  StructField('Settlement_Type', StringType(), True),
  StructField('Strike', DoubleType(), True),
  StructField('Tran_Num', IntegerType(), True),
  StructField('Volume', DoubleType(), True),
])
